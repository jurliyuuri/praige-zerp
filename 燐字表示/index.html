<head>
<script>
onload = function() {
	for(var i=0; i<20; i++){
		for(var j=0;j<10; j++){
		draw('c1',i,j, 0.2, i*60, j*60);	
		}
	}
	draw('c2',14,3,1);

};

</script>
<script src="main.js"></script>
</head>
<body>
<canvas id="c1" width="1200" height="600" ></canvas>
<canvas id="c2" width="240" height="240" ></canvas>
<hr>
<h1>燐字表示機構開発ログ</h1>
<h2>1. まずは表示から</h2>
<p>いちいち切り分けるのとかめんどいので、巨大なファイルとして読み込んでおいて、それをcanvasで切り出す方針でやってみよう。少しでもサイズを節約するために余白を削って5000x3600にする。</p>
<p>まず、1枚目の原稿用紙。表の4頂点に位置する4字の座標を取って、あとはこれを最小二乗法に突っ込んでアフィン変換とすれば良い。</p>
<p>実験をすると</p>
<pre>
      y1,   y2      s1 s2
我:  159,  245 --->  0, 0
位: 4658,  254 ---> 19, 0
硬: 4645, 3290 ---> 19, 9
形:  150, 3281 --->  0, 9
</pre>
<p>である。うまいパラメータt<sub>10</sub>, t<sub>11</sub>, t<sub>12</sub>, t<sub>20</sub>, t<sub>21</sub>, t<sub>22</sub>を持ってきて、</p>
<linzi1 src="matrix.png" width="600"/>
<p>となるようにしてやれば良い。ただしs<sub>0</sub>たちは全部1である。</p>
<p>Y ≒ TSで最小二乗法をやるのでYS<sup>T</sup>=TSS<sup>T</sup>を解けばよく、T=YS<sup>T</sup>(SS<sup>T</sup>)<sup>-1</sup>なのでTは</p>
<pre>
[[ 160.        ,  236.68421053,   -1.22222222],
 [ 245.        ,    0.47368421,  337.33333333]]
</pre>
<p>なるほど。実際にやってみると上手くいったのでやったぜ。</p>
</body>